const fetch = require('node-fetch');

class BlogPlatformAPI {
  constructor(baseURL = 'http://localhost:3001') {
    this.baseURL = baseURL;
  }

  // Health check
  async healthCheck() {
    const response = await fetch(`${this.baseURL}/health`);
    return await response.json();
  }

  // Create a new blog post
  async createBlogPost(blogData) {
    const response = await fetch(`${this.baseURL}/api/blogs`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(blogData)
    });
    return await response.json();
  }

  // Get all blog posts
  async getBlogPosts(published = true, limit = 50) {
    const response = await fetch(`${this.baseURL}/api/blogs?published=${published}&limit=${limit}`);
    return await response.json();
  }

  // Get blog post by ID
  async getBlogPost(id) {
    const response = await fetch(`${this.baseURL}/api/blogs/${id}`);
    return await response.json();
  }

  // Update blog post
  async updateBlogPost(id, updates) {
    const response = await fetch(`${this.baseURL}/api/blogs/${id}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(updates)
    });
    return await response.json();
  }

  // Delete blog post
  async deleteBlogPost(id) {
    const response = await fetch(`${this.baseURL}/api/blogs/${id}`, {
      method: 'DELETE'
    });
    return await response.json();
  }

  // Get all tags
  async getTags() {
    const response = await fetch(`${this.baseURL}/api/tags`);
    return await response.json();
  }

  // Upload image
  async uploadImage(imageData, fileName) {
    const response = await fetch(`${this.baseURL}/api/upload-image`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        imageData,
        fileName
      })
    });
    return await response.json();
  }
}

// Example AI Bot Integration
class AIBlogBot {
  constructor(apiBaseURL) {
    this.api = new BlogPlatformAPI(apiBaseURL);
  }

  // Generate a blog post about AI trends
  async generateAIBlogPost() {
    const blogData = {
      title: {
        en: "The Future of AI in Business: 2024 Trends and Predictions",
        he: "עתיד הבינה המלאכותית בעסקים: מגמות ותחזיות 2024"
      },
      content: {
        en: `# The Future of AI in Business: 2024 Trends and Predictions

Artificial Intelligence continues to revolutionize how businesses operate, and 2024 is no exception. Here are the key trends that will shape the business landscape this year.

## 1. **Generative AI Goes Mainstream**

Generative AI tools like ChatGPT, DALL-E, and Midjourney are becoming essential business tools. Companies are using these technologies for:

- **Content Creation**: Automated blog posts, social media content, and marketing materials
- **Design**: Logo creation, website design, and product mockups
- **Customer Service**: AI-powered chatbots and virtual assistants

## 2. **AI-Powered Decision Making**

Businesses are increasingly relying on AI for strategic decision-making:

- **Predictive Analytics**: Forecasting market trends and customer behavior
- **Risk Assessment**: Identifying potential risks and opportunities
- **Resource Optimization**: Maximizing efficiency in operations and logistics

## 3. **Personalization at Scale**

AI enables businesses to deliver personalized experiences to customers:

- **Recommendation Engines**: Suggesting products and services based on user behavior
- **Dynamic Pricing**: Adjusting prices based on demand and customer segments
- **Customized Marketing**: Tailoring campaigns to individual preferences

## The Road Ahead

As AI technology continues to evolve, businesses that embrace these trends will gain a competitive advantage. The key is to start small, experiment, and scale successful implementations.

*This post was generated by an AI assistant to demonstrate the capabilities of our blog platform API.*`,
        he: `# עתיד הבינה המלאכותית בעסקים: מגמות ותחזיות 2024

הבינה המלאכותית ממשיכה להפוך את האופן שבו עסקים פועלים, ו-2024 אינה יוצאת דופן. הנה המגמות המרכזיות שיעצבו את נוף העסקים השנה.

## 1. **בינה מלאכותית גנרטיבית הופכת למיינסטרים**

כלים של בינה מלאכותית גנרטיבית כמו ChatGPT, DALL-E ו-Midjourney הופכים לכלים עסקיים חיוניים. חברות משתמשות בטכנולוגיות אלה עבור:

- **יצירת תוכן**: פוסטים אוטומטיים לבלוג, תוכן לרשתות חברתיות וחומרי שיווק
- **עיצוב**: יצירת לוגואים, עיצוב אתרים ומודלים של מוצרים
- **שירות לקוחות**: צ'אטבוטים וסייעים וירטואליים מונעי AI

## 2. **קבלת החלטות מונעת AI**

עסקים מסתמכים יותר ויותר על AI לקבלת החלטות אסטרטגיות:

- **ניתוח חיזוי**: חיזוי מגמות שוק והתנהגות לקוחות
- **הערכת סיכונים**: זיהוי סיכונים והזדמנויות פוטנציאליות
- **אופטימיזציה של משאבים**: מקסום יעילות בפעולות ולוגיסטיקה

## 3. **התאמה אישית בקנה מידה**

AI מאפשר לעסקים לספק חוויות מותאמות אישית ללקוחות:

- **מנועי המלצות**: הצעת מוצרים ושירותים בהתבסס על התנהגות משתמש
- **תמחור דינמי**: התאמת מחירים בהתבסס על ביקוש וקהלי יעד
- **שיווק מותאם**: התאמת קמפיינים להעדפות אישיות

## הדרך קדימה

ככל שטכנולוגיית ה-AI ממשיכה להתפתח, עסקים שיאמצו מגמות אלה יזכו ביתרון תחרותי. המפתח הוא להתחיל בקטן, להתנסות ולהגדיל יישומים מוצלחים.

*פוסט זה נוצר על ידי עוזר AI כדי להדגים את יכולות ה-API של פלטפורמת הבלוג שלנו.*`
      },
      excerpt: {
        en: "Discover the key AI trends that will shape business operations in 2024, from generative AI to personalized customer experiences.",
        he: "גלה את מגמות ה-AI המרכזיות שיעצבו את פעולות העסק ב-2024, מבינה מלאכותית גנרטיבית ועד חוויות לקוח מותאמות אישית."
      },
      tags: ["AI", "Business", "Technology", "Trends", "2024", "Innovation"],
      published: false,
      author: {
        name: "AI Blog Assistant",
        email: "ai@company.com"
      }
    };

    return await this.api.createBlogPost(blogData);
  }

  // Generate a blog post about automation
  async generateAutomationBlogPost() {
    const blogData = {
      title: {
        en: "How Automation is Transforming Small Businesses",
        he: "כיצד אוטומציה משנה עסקים קטנים"
      },
      content: {
        en: `# How Automation is Transforming Small Businesses

Small businesses are discovering that automation isn't just for large corporations anymore. Here's how automation is leveling the playing field.

## **The Automation Revolution**

Automation tools are now accessible and affordable for businesses of all sizes:

- **Marketing Automation**: Email campaigns, social media scheduling, and lead nurturing
- **Customer Service**: Chatbots, automated responses, and ticket management
- **Accounting**: Invoice processing, expense tracking, and financial reporting

## **Real-World Benefits**

Small businesses implementing automation report:

- **50% reduction** in manual tasks
- **30% increase** in customer satisfaction
- **25% improvement** in operational efficiency

## **Getting Started**

The key to successful automation is starting with the right processes:

1. **Identify repetitive tasks** that consume valuable time
2. **Choose the right tools** for your specific needs
3. **Train your team** on new automated workflows
4. **Monitor and optimize** performance continuously

*This post was generated by an AI assistant to demonstrate the capabilities of our blog platform API.*`,
        he: `# כיצד אוטומציה משנה עסקים קטנים

עסקים קטנים מגלים שאוטומציה אינה רק עבור תאגידים גדולים יותר. הנה כיצד אוטומציה מחשבת את שדה המשחק.

## **מהפכת האוטומציה**

כלי אוטומציה זמינים כעת ונגישים לעסקים מכל הגדלים:

- **אוטומציה שיווקית**: קמפיינים באימייל, תזמון רשתות חברתיות וטיפוח לידים
- **שירות לקוחות**: צ'אטבוטים, תגובות אוטומטיות וניהול כרטיסים
- **חשבונאות**: עיבוד חשבוניות, מעקב הוצאות ודיווחים פיננסיים

## **יתרונות בעולם האמיתי**

עסקים קטנים המיישמים אוטומציה מדווחים על:

- **הפחתה של 50%** במשימות ידניות
- **עלייה של 30%** בשביעות רצון לקוחות
- **שיפור של 25%** ביעילות תפעולית

## **התחלה**

המפתח לאוטומציה מוצלחת הוא להתחיל עם התהליכים הנכונים:

1. **זיהוי משימות חוזרות** שצורכות זמן יקר
2. **בחירת הכלים הנכונים** לצרכים הספציפיים שלכם
3. **הכשרת הצוות** על זרימות עבודה אוטומטיות חדשות
4. **ניטור ואופטימיזציה** של ביצועים ברציפות

*פוסט זה נוצר על ידי עוזר AI כדי להדגים את יכולות ה-API של פלטפורמת הבלוג שלנו.*`
      },
      excerpt: {
        en: "Discover how automation tools are helping small businesses compete with larger corporations and improve their operational efficiency.",
        he: "גלה כיצד כלים אוטומציה עוזרים לעסקים קטנים להתחרות עם תאגידים גדולים יותר ולשפר את היעילות התפעולית שלהם."
      },
      tags: ["Automation", "Small Business", "Efficiency", "Technology", "Innovation"],
      published: false,
      author: {
        name: "AI Blog Assistant",
        email: "ai@company.com"
      }
    };

    return await this.api.createBlogPost(blogData);
  }

  // Publish a draft blog post
  async publishBlogPost(blogId) {
    return await this.api.updateBlogPost(blogId, {
      published: true
    });
  }

  // Get all draft posts
  async getDraftPosts() {
    return await this.api.getBlogPosts(false, 100);
  }

  // Get all published posts
  async getPublishedPosts() {
    return await this.api.getBlogPosts(true, 100);
  }
}

// Example usage
async function demonstrateAIBot() {
  console.log('🤖 AI Blog Bot Demonstration\n');

  const bot = new AIBlogBot('http://localhost:3001');

  try {
    // Check API health
    console.log('1. Checking API health...');
    const health = await bot.api.healthCheck();
    console.log('✅ API Status:', health.status);

    // Generate AI blog post
    console.log('\n2. Generating AI blog post...');
    const aiPost = await bot.generateAIBlogPost();
    
    if (aiPost.success) {
      console.log('✅ AI blog post created successfully');
      console.log('   ID:', aiPost.data.id);
      console.log('   Title:', aiPost.data.title.en);
      console.log('   Status:', aiPost.data.published ? 'Published' : 'Draft');

      // Generate automation blog post
      console.log('\n3. Generating automation blog post...');
      const automationPost = await bot.generateAutomationBlogPost();
      
      if (automationPost.success) {
        console.log('✅ Automation blog post created successfully');
        console.log('   ID:', automationPost.data.id);
        console.log('   Title:', automationPost.data.title.en);

        // Get all draft posts
        console.log('\n4. Getting all draft posts...');
        const drafts = await bot.getDraftPosts();
        console.log('✅ Found', drafts.data.length, 'draft posts');

        // Publish the AI post
        console.log('\n5. Publishing AI blog post...');
        const publishResult = await bot.publishBlogPost(aiPost.data.id);
        
        if (publishResult.success) {
          console.log('✅ Blog post published successfully');
        } else {
          console.log('❌ Failed to publish:', publishResult.error);
        }

        // Get all published posts
        console.log('\n6. Getting all published posts...');
        const published = await bot.getPublishedPosts();
        console.log('✅ Found', published.data.length, 'published posts');

        // Get all tags
        console.log('\n7. Getting all tags...');
        const tags = await bot.api.getTags();
        console.log('✅ Available tags:', tags.data);

      } else {
        console.log('❌ Failed to create automation post:', automationPost.error);
      }
    } else {
      console.log('❌ Failed to create AI post:', aiPost.error);
    }

  } catch (error) {
    console.error('❌ Demonstration failed:', error.message);
  }

  console.log('\n🏁 AI Bot demonstration completed!');
}

// Run the demonstration
if (require.main === module) {
  demonstrateAIBot();
}

module.exports = { BlogPlatformAPI, AIBlogBot }; 